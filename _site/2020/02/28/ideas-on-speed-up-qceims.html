<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How to Speed up QCEIMS | Quantum chemistry notes in mass spectrometry</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="How to Speed up QCEIMS" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to Speed up QCEIMS QC method" />
<meta property="og:description" content="How to Speed up QCEIMS QC method" />
<link rel="canonical" href="http://localhost:4000/2020/02/28/ideas-on-speed-up-qceims.html" />
<meta property="og:url" content="http://localhost:4000/2020/02/28/ideas-on-speed-up-qceims.html" />
<meta property="og:site_name" content="Quantum chemistry notes in mass spectrometry" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-02-28T13:24:52-08:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/02/28/ideas-on-speed-up-qceims.html"},"description":"How to Speed up QCEIMS QC method","headline":"How to Speed up QCEIMS","dateModified":"2020-02-28T13:24:52-08:00","datePublished":"2020-02-28T13:24:52-08:00","url":"http://localhost:4000/2020/02/28/ideas-on-speed-up-qceims.html","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Quantum chemistry notes in mass spectrometry" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Quantum chemistry notes in mass spectrometry</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to Speed up QCEIMS</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-02-28T13:24:52-08:00" itemprop="datePublished">Feb 28, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="how-to-speed-up-qceims">How to Speed up QCEIMS</h2>
<h3 id="qc-method">QC method</h3>

<ol>
  <li>Multiple time step integrator</li>
</ol>

<p><strong>Plan:</strong> break down GFN-xTB Hamiltonian into fast and slow part</p>

<p>This is a challenging but doable part for me. To solve this problem, I need better understand on
 quantum chemistry and molecular dynamics. Also, since Lee-Ping is the expert in this field,
 I need to talk to him more frequently and regularly. If I can solve this problem before my QE,
 I will have 100% confidence to pass it.</p>

<ol>
  <li>Combine different methods</li>
</ol>

<p><strong>Plan:</strong> OM2 as ground state MD and GFN-xTB as production</p>

<p><strong>Ground state MD Energy</strong><br />
  <img src="/image/new143energy.png" alt="GFN_energy" /></p>

<p>GFN <em>GFN has more energy levels</em>
  <img src="/image/143energy.png" alt="OM2_energy" /></p>

<p>OM2 methods</p>

<p>This is an easy trial. Just modify the codes and keep the nodes running. Can be done at free time.</p>

<h3 id="statistical-method">Statistical method</h3>
<ol>
  <li>Get a stable spectrum with less MD times</li>
</ol>

<p><strong>Production MD #fragments</strong>
  <img src="/image/newversion143.png" alt="GFN_fragment" /></p>

<p>GFN <em>GFN has longer simulation time</em></p>

<p><img src="/image/143fragments.png" alt="OM2_fragment" /></p>

<p>OM2 methods</p>

<ol>
  <li>Change parameters</li>
</ol>

<p>This could be the main part for my QE project. We already had some results and it’s easy
to draw some conclusions. But we need to collect more chemistry knowledge into explanation.</p>

<h3 id="cs-method">CS method</h3>
<ol>
  <li>openMP
  how to parallel</li>
  <li>running time analyses
  Find out witch step takes more time:
  <a href="https://docs.oracle.com/cd/E19957-01/805-4940/6j4m1u7q2/index.html">Performance Profiling</a></li>
</ol>

<p>I am very interested in this subproject, this will help us understand how it runs on CPUs better.
And we can find a way to optimize the codes, even transfer the code to GPUs. But this project is
a littel far away from chemistry. I am more willing to dig into this after QE.</p>

<h2 id="need-to-do">Need to do</h2>
<ul>
  <li>At this time, finishing the QCEIMS paper has the highest priority. <strong>Before Friday Dec 6</strong></li>
  <li>Get the statistical method test code running. <strong>This weekend</strong></li>
  <li>Finish a review paper on QCEIMS and it’s application in metabolomics.<strong>Before the end of this quarter</strong></li>
  <li>Finish the draft and talk with Dean about the gold project paper. <strong>Winter break</strong></li>
</ul>

<h2 id="task-external">Task external</h2>

<p>1) Code parser for qceims.out to calculate the reason of exit and time steps.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>step   time [fs]    Epot       Ekin       Etot    error  #F   eTemp   frag. T | 	Reason
--------------------------------------------------------------------------------------------------
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached
    900   1380.    -25.06868   0.1446   -24.92406  0.0006 1   21000.    4104.        	E X I T   M D  because of tmax has been reached

</code></pre></div></div>

<p>2) Analyze time [fs] for exit and</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
    							Count	Percent
    E X I T   M D  because nothing happens here anymore	194	25.12953
    E X I T   M D  because of nfrag=nfragexit		186	24.09326
    E X I T   M D  because of tmax has been reached	339	43.91192
    E X I T   M D  because of multiple fragments	53	6.86528




</code></pre></div></div>
<p>3) Analyze quality of spectra with 5,10,15,20,25 * number of atoms, based on qceims.res analysis for subsequent temp directories</p>

<h2 id="program-got-stuck">Program got stuck</h2>

<h3 id="scc-not-converged">SCC not converged</h3>
<h4 id="reason1-actual-2-fragments-but-we-thought-its-one-qceimsout">Reason1: Actual 2 fragments, but we thought it’s one. (qceims.out)</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   inter fragment distances (Angst.)

           1         2         3         4

    1   0.00000
    2   4.93472   0.00000
    3  15.69160  18.64043   0.00000
    4  16.03335  13.62240  28.79924   0.00000

 computing IPs with XTB at (K)   4916.
SCC not converged
</code></pre></div></div>
<p><strong>solution: hard to find a better way to define a fragment; need a lot of tests.</strong>
coord:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>8

S	4.21054	8.02837	-0.31989
C	5.1151	8.0825	-3.048
C	13.0601	7.79535	-1.04052
H	6.92649	8.61662	-3.82286
H	3.65999	7.29727	-4.28192
H	11.0054	7.33935	-0.98352
H	14.30881	7.11221	0.40712
H	13.01674	9.77721	-1.83008
</code></pre></div></div>

<h4 id="reason2-just-not-convergedqceimsout">Reason2: Just not converged(qceims.out)</h4>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>avcycle =   50    more =  250

step   time [fs]    Epot       Ekin       Etot    error  #F   eTemp   frag. T
      0      0.    -20.18971   0.0594   -20.13029  0.0000 1    5000.     695.
    100     50.    -20.17594   0.0966   -20.07935  0.0000 1    5000.     942.
    200    100.    -20.14071   0.1454   -19.99528  0.0000 1    5000.    1151.
    300    150.    -20.07645   0.1649   -19.91152  0.0000 1    5000.    1381.
    400    200.    -20.08032   0.2432   -19.83716  0.0000 1    5000.    1659.
    500    250.    -20.03967   0.2505   -19.78916  0.0000 1    5000.    1905.
    600    300.    -20.02677   0.2772   -19.74956  0.0000 1    5000.    2129.
    700    350.    -19.98898   0.3543   -19.63470  0.0000 1    5000.    2345.
    800    400.    -19.98386   0.4064   -19.57748  0.0000 1    5000.    2606.
    900    450.    -19.92756   0.3623   -19.56528  0.0000 1    5000.    2842.
   1000    500.    -19.92721   0.4715   -19.45567  0.0000 1    5000.    3064.
   1100    550.    -19.95021   0.5111   -19.43912  0.0000 2    5000.    3645.  8466.
   1200    600.    -20.00059   0.5600   -19.44060  0.0000 2    5000.    3916.  9360.
   1300    650.    -19.92554   0.4969   -19.42863  0.0000 2    5000.    3781.  7905.
   1400    700.    -19.84840   0.4265   -19.42191  0.0000 2    5000.    3796.  6122.
   1500    750.    -19.81527   0.3804   -19.43484  0.0000 3    5000.    3270.  4055.  7832.
SCC not converged
</code></pre></div></div>
<p><strong>solution: catch the error information and stop the process</strong>
coord:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>18			

S	1.78274	7.82976	8.34857
C	6.40366	17.0264	-11.22789
C	4.90113	18.73804	-10.46774
C	-10.72444	17.38046	-14.34567
C	1.40078	4.1999	13.71945
C	1.08827	1.57931	12.5908
H	5.1336	19.74066	-8.86432
H	6.48994	15.31812	-10.83998
H	7.30355	18.84539	-11.56004
H	3.15313	10.02538	7.96832
H	-10.06331	16.13587	-13.007
H	-10.03317	16.27188	-16.18967
H	-10.04083	18.98395	-13.82771
H	-0.45977	5.08437	13.87991
H	3.23205	4.78335	14.31882
H	2.93856	0.97881	11.74942
H	0.36766	2.51487	10.51831
H	0.00497	-0.07728	13.04497
</code></pre></div></div>
<p>When we repeat those two mnolecules, it will be converged.
Something could be wrong with the system!</p>
<h3 id="cant-find-parameter-file">Can’t find parameter file</h3>
<p><strong>solution: complie the GFN parameter file in the program</strong></p>

  </div><a class="u-url" href="/2020/02/28/ideas-on-speed-up-qceims.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Quantum chemistry notes in mass spectrometry</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Quantum chemistry notes in mass spectrometry</li><li><a class="u-email" href="mailto:sywang@ucdavis.edu">sywang@ucdavis.edu</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/shunyang2018"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">shunyang2018</span></a></li><li><a href="https://www.twitter.com/"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username"></span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
